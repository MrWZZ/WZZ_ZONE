<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title></title>
    <link rel="stylesheet" href="/WZZ_ZONE/pages/summary.css">
  </head>
  <body>
<pre class="w_doc">
<h1 class="h1">cookie、session</h1>
  <b>cookie</b>
  + 保存在客户端。
  + 本身不安全，用户可以自己更改。
  + 大小有限：4K。
  + 每次请求都会将COOKIE带到服务器去。
  + 访问的权限为父目录可以访问子目录，子目录不可以访问父目录。

  <b>session</b>
  + 保存在服务端。
  + 大小可以自己控制。
  + 基于COOKIE存在。

<h1 class="h1">cookie的使用</h1>
  所需中间件：cookie-parser
  代码：
  <xmp class="block">
    const express = require("express");
    const cookieParser = require("cookie-parser");
    var server = express();

    //cookie
    server.use(cookieParser("密钥"));       //密钥可选

    server.use("/",function(req,res){

      //读取
      console.log(req.signedCookies);       //已签名
      console.log(req.cookies);             //未签名

      //发送
      res.cookie("key","value",{path:"/aaa"});

      //cookie签名，防止修改---------------------------
      //res.cookie("key","value",{signed:true});

      //删除
      res.clearCookie("key");

    });

    server.listen(8080);
  </xmp>

<h1 class="h1">session的使用</h1>
  所需中间件：cookie-session
  代码：
  <xmp class="block">
    //此处省略上面的COOKIE的引用，要用SESSION，需要先解析COOKIE。
    const express = require("express");
    const cookieSession = require("cookie-session");

    var server = express();

    server.use(cookieSession(
    {
      //密钥数组
      keys : ["key1","key2","key3"]
    }
    ));

    server.use("/",function(req,res)
    {
      //读取
      console.log(req.session);

      //删除
      delete res.session["key"];
    });

    server.listen(8080);
  </xmp>
</pre>
  </body>
</html>
